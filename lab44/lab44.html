<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        body {
            text-align: center;
            margin: 50px;
            background-color: #f4f4f4;
        }

        .container {
            max-width: 400px;
            height: auto;
            margin: auto;
            padding: 15px;
            border-radius: 5px;
            background: white;
        }

        input {
            width: 70%;
            padding: 10px;
            border: 1px solid black;
            border-radius: 5px;
        }

        button {
            padding: 10px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        ul {
            list-style: none;
            padding: 0;
        }

        .task {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            background: #fff;
            padding: 10px;
            margin: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .buttons {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            position: absolute;
            right: 0;
        }

        .task:hover {
            background: #ddd;
        }

        .task button {
            background-color: gray;
            color: black;
        }

        .completed {
            text-decoration: line-through;
            color: gray;
        }
    </style>

    <title>Lab 44</title>
</head>

<body>
    <h2>To-Do List</h2>

    <div class="container">
        <input id="input" type="text" placeholder="Enter a task">
        <button id="addTask">Add Task</button>
        <ul id="list"></ul>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", loadTasks);

        let input = document.getElementById("input");
        let btn = document.getElementById("addTask");
        let list = document.getElementById("list");

        btn.onclick = function() {
            let text = input.value.trim();

            if (text === "") {
                alert("Task was not entered");
                return;
            }

            let div = document.createElement("div");
            div.classList.toggle("task");

            let li = document.createElement("li");
            li.textContent = text;

            let divBtn = document.createElement("div");
            divBtn.classList.toggle("buttons");

            let del = document.createElement("button");
            del.textContent = "x";

            let edit = document.createElement("button");
            edit.textContent = "Edit";

            div.onclick = function() {
                li.classList.toggle("completed");
                saveTasks();
            }

            del.onclick = function() {
                list.removeChild(div);
                saveTasks();
            }

            edit.onclick = function() {
                let editInput = document.createElement("input");

                editInput.type = "text";
                editInput.placeholder = "Edit a task";

                div.insertBefore(editInput, div.firstChild);
                li.style.display = "none";

                editInput.addEventListener("keydown", function(event) {
                    if (event.key === "Enter") {
                        let editText = editInput.value.trim();

                        li.textContent = editText;

                        div.removeChild(editInput);
                        li.style.display = "flex";
                    }
                })
            }

            div.appendChild(li);
            div.appendChild(divBtn);

            divBtn.appendChild(del);
            divBtn.appendChild(edit);

            list.appendChild(div);
            input.value = "";

            saveTasks();
        }

        function saveTasks() {
            let tasks = [];

            document.querySelectorAll("#list li").forEach(task => {
                tasks.push({text: task.textContent, completed: task.classList.contains("completed")});
            })

            localStorage.setItem("tasks", JSON.stringify(tasks));
        }

        function loadTasks() {
            let storedTasks = localStorage.getItem("tasks");

            if (storedTasks) {
                let tasks = JSON.parse(storedTasks);

                tasks.forEach(task => {
                    let div = document.createElement("div");
                    div.classList.toggle("task");

                    let li = document.createElement("li");
                    li.textContent = task.text;

                    let divBtn = document.createElement("div");
                    divBtn.classList.toggle("buttons");

                    let del = document.createElement("button");
                    del.textContent = "x";

                    let edit = document.createElement("button");
                    edit.textContent = "Edit";

                    if (task.completed) {
                        li.classList.add("completed");
                    }

                    div.onclick = function() {
                        li.classList.toggle("completed");
                        saveTasks();
                    }

                    del.onclick = function() {
                        list.removeChild(div);
                        saveTasks();
                    }

                    edit.onclick = function() {
                        let editInput = document.createElement("input");

                        editInput.type = "text";
                        editInput.placeholder = "Edit a task";

                        div.insertBefore(editInput, div.firstChild);
                        li.style.display = "none";

                        editInput.addEventListener("keydown", function(event) {
                            if (event.key === "Enter") {
                                let editText = editInput.value.trim();

                                li.textContent = editText;

                                div.removeChild(editInput);
                                li.style.display = "flex";
                            }
                        })
                    }

                    div.appendChild(li);
                    div.appendChild(divBtn);

                    divBtn.appendChild(del);
                    divBtn.appendChild(edit);

                    list.appendChild(div);
                })
            }
        }
    </script>
</body>
</html>